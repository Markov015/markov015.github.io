---
layout: post

title: 最大公因数与最小公倍数

date:   2019-07-05 14:11:00 +0800

categories: 

tag: 算法
---

## 定义
设$a_1, a_2, \cdots, a_n$是$n(n\geq2)$个整数，若整数$d | a_i, i = 1, 2, \cdots, n,$则称$d$是$a_1, a_2, \cdots, a_n$的一个公因数。

公因数中最大的那个称作是最大公因数，记作$(a_1, a_2, \cdots, a_n)$.

## 最大公因数
### 求两个数的最大公因数
#### 辗转相除法
辗转相除法在西方又叫欧几里得除法，在我国古代数学著作《九章算术》中也叫更相减损术。它有很多用处，其中之一就是求两个正整数的最大公因数。

设$a,b \in N_{+}$，由带余除法，成立
> $a = b q_1 + r_1, 0 < r_1 < b$
> $b = r_1 q_2 + r_2, 0 < r_2 < r_1$
> $r_1 = r_2 q_3 + r_3, 0 < r_3 <r_2$
> $\cdots$
> $r_{n-2} = r_{n-1} q_n + r_n, 0 < r_n < r_{n-1}$
> $r_{n-1} = r_n q_{n+1}, r_{n+1} = 0$

由于每做一次带余除法，余数至少减一，并且余数小于b，所以至多b次带余除法之后，余数一定变为0。

<!-- more -->

#### 引理1
若$a,b \in N_{+}$,由带余除法知$\exists b,q \in N_{+}$成立$$a = b q + r, 0 < r < b.$$
则有$$（a, b）= (b, r)$$

证明：
> 若d是a和b的公因数，则由 $r = a - bq$ 知d是r的因数，故d也是b和r的公因数。
> 若d是b和r的公因数，则由 $a = bq + r$ 知d是a的因数，故d也是a和b的公因数。
> 因此$a,b$和$b、r$具有相同的公因数，因此它们的最大公因数相同。

#### 定理1
若$a,b \in N_{+}$，则$(a,b) = r_n$.
证明：
> 由辗转相除法和上述引理知：
> $（a, b) = (b,r_1) = (r_1, r_2) = \cdots = (r_{n-1}, r_n) = (r_n, 0) = r_n$

#### 算法实现(C++)
求两个数的最大公因数直接利用辗转相除法即可得到，算法实现如下：

```c++
#include <cassert>
// 求a、b的最大公因数
long gcd(long a, long b) {
	assert(a || b); // a、b不能同时为0
	return b ? gcd(b, a % b) : a;
}
```
### 求多个数的最大公因数
#### 定理2
设$a_1, a_2, \cdots, a_n \in N_{+}$, 则成立
$$（a_1, a_2, \cdots, a_n）= ((a_1, a_2, \cdots,a_{n-1}), a_n).$$

证明：
> 设$（a_1, a_2） = d_2, (d_2, a_3) = d_3,\cdots, (d_{n-1}, a_n) = d_n$.
> 则显然$d_n$是$a_1, a_2, \cdots, a_n$的公因数.
> 若d是$a_1, a_2, \cdots, a_n$的任一公因数，则由$d|a_1，d|a_2$知$d|d_2$，又因为$d|a_3$知$d|d_3$，以此类推，知$d|d_n$.
> 由以上可知$d_n$是最大公因数.

#### 算法实现
由定理2实现如下:

```c++
// 求A[0...n-1]的最大公因数
long gcd(long A[], int n) {
	long res = A[0];
	for(int i = 1; i < n; i++) {
	
}
```

## 最小公倍数
### 求两个数的最小公倍数
```c++
long lcm(long a, long b) {
	return a * b / gcd(a, b); 
}
```
### 求多个数的最小公倍数

